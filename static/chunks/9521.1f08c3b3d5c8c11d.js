"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9521],{51289:(e,t,n)=>{n.d(t,{N:()=>a});var i=n(85553);let r="https://bhhsxrupcbhbrqyqxcyd.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJoaHN4cnVwY2JoYnJxeXF4Y3lkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3NDAzNjYsImV4cCI6MjA3ODMxNjM2Nn0._y2DYaQZzAKQTvXwLmooFrwJBKE4w1nsWfa3rpk95M8";if(!r||!s)throw Error("❌ Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in Netlify.");let a=(0,i.UU)(r,s,{auth:{persistSession:!1}})},59521:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var i=n(95155),r=n(41574),s=n(98638),a=n(80317),l=n(41942),o=n(12115),c=n(35348),d=n(7291),u=n(13664);function x(e){let{selected:t,setSelected:n}=e,s=["Buy Now","On Auction","Has Offers"];return(0,i.jsxs)(r.default,{sx:{background:"linear-gradient(100deg, #1C0370, #0B041C)",pl:2,py:1,borderRadius:2,mb:3},children:[(0,i.jsx)(a.A,{sx:{fontWeight:500,mb:1,fontSize:"1.2rem"},children:"Status"}),(0,i.jsx)(c.A,{children:s.map((e,r)=>(0,i.jsx)(d.A,{control:(0,i.jsx)(u.A,{checked:t.includes(e),onChange:()=>{t.includes(e)?n(t.filter(t=>t!==e)):n([...t,e])},sx:{transform:"scale(0.9)",color:"#a78bfa","&.Mui-checked":{color:"#a78bfa"}}}),label:e,sx:{marginBottom:r===s.length-1?0:"-11px","& .MuiFormControlLabel-label":{fontSize:"0.95rem",color:"#ffffff"}}},e))})]})}var h=n(50355);let f=["ApeCrypto","Space Kitties","Retro Bots","Pixel Worlds","Crypto Punks","Bored Apes","Mecha Monkeys","Alien Cats"];function g(e){let{selected:t,setSelected:n}=e,[s,l]=(0,o.useState)(!1),[x,g]=(0,o.useState)(""),m=(s?f:f.slice(0,4)).filter(e=>e.toLowerCase().includes(x.toLowerCase()));return(0,i.jsxs)(r.default,{sx:{background:"linear-gradient(125deg, #1C0370, #0B041C)",p:2.5,borderRadius:2,mb:3},children:[(0,i.jsx)(a.A,{sx:{fontWeight:500,mb:1,fontSize:"1.2rem"},children:"Collections"}),(0,i.jsx)(h.A,{variant:"outlined",placeholder:" \uD83D\uDD0DSearch collections",size:"small",value:x,onChange:e=>g(e.target.value),sx:{width:"100%",mb:1.5,"& .MuiOutlinedInput-root":{borderRadius:1.5,background:"#fff",input:{p:.8}}}}),(0,i.jsx)(c.A,{children:m.map(e=>(0,i.jsx)(d.A,{control:(0,i.jsx)(u.A,{checked:t.includes(e),onChange:()=>{t.includes(e)?n(t.filter(t=>t!==e)):n([...t,e])},sx:{transform:"scale(0.9)",color:"#a78bfa","&.Mui-checked":{color:"#a78bfa"}}}),label:e,sx:{"& .MuiFormControlLabel-label":{color:"#ffffff"}}},e))}),f.length>4&&(0,i.jsx)(a.A,{sx:{mt:1,fontSize:13,color:"#a78bfa",cursor:"pointer"},onClick:()=>l(!s),children:s?"See less...":"See more..."})]})}var m=n(24288),p=n(35346),w=n(39620);let b=[{category:"Background",items:[{name:"Beanie",percent:15},{name:"Crown",percent:12}]},{category:"Hat",items:[{name:"Sunglasses",percent:20}]},{category:"Eyes",items:[{name:"Cap",percent:35},{name:"Laser Eyes",percent:5}]}];function A(e){let{selected:t,setSelected:n}=e,[s,x]=(0,o.useState)(b.reduce((e,t)=>({...e,[t.category]:!1}),{}));return(0,i.jsxs)(r.default,{sx:{background:"linear-gradient(125deg, #1C0370, #0B041C)",p:2.5,borderRadius:2},children:[(0,i.jsx)(a.A,{sx:{fontWeight:500,mb:1,fontSize:"1.2rem"},children:"Properties (ApeCrypto)"}),b.map(e=>(0,i.jsxs)(r.default,{sx:{mb:1.5},children:[(0,i.jsxs)(l.A,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsxs)(a.A,{sx:{fontSize:"0.95rem"},children:[e.category," (",e.items.length,")"]}),(0,i.jsx)(m.A,{size:"small",onClick:()=>{let t;return t=e.category,x(e=>({...e,[t]:!e[t]}))},sx:{color:"white"},children:(0,i.jsx)(w.A,{sx:{transform:s[e.category]?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"}})})]}),(0,i.jsx)(p.A,{in:s[e.category],sx:{mt:1},children:(0,i.jsx)(c.A,{sx:{ml:1},children:e.items.map(r=>(0,i.jsx)(d.A,{control:(0,i.jsx)(u.A,{checked:(t[e.category]||[]).includes(r.name),onChange:()=>((e,i)=>{let r=t[e]||[],s=r.includes(i)?r.filter(e=>e!==i):[...r,i];n({...t,[e]:s})})(e.category,r.name),sx:{transform:"scale(0.9)",color:"#a78bfa","&.Mui-checked":{color:"#a78bfa"}}}),label:"".concat(r.name," (").concat(r.percent,"%)"),sx:{"& .MuiFormControlLabel-label":{color:"#ffffff",fontSize:"0.95rem"}}},r.name))})})]},e.category))]})}var j=n(22591);function y(e){let{statusSelected:t,setStatusSelected:n}=e,[s,c]=(0,o.useState)({min:"",max:""}),[d,u]=(0,o.useState)([]),[h,f]=(0,o.useState)({}),{data:m=[]}=(0,j.Fu)(),[p,w]=(0,o.useState)([]);return(0,j.Rd)(m,p),(0,i.jsxs)(r.default,{sx:{px:3,borderRadius:3,color:"white",width:{xs:"100%",sm:"115%",md:"105%"},fontFamily:"Inter, sans-serif"},children:[(0,i.jsxs)(l.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[(0,i.jsx)(a.A,{sx:{fontWeight:600},children:"Filters"}),(0,i.jsx)(a.A,{sx:{color:"#a78bfa",fontSize:13,cursor:"pointer"},onClick:()=>{n([]),c({min:"",max:""}),u([]),f({})},children:"Clear All"})]}),(0,i.jsx)(x,{selected:t,setSelected:n}),(0,i.jsx)(g,{selected:d,setSelected:u}),(0,i.jsx)(A,{selected:h,setSelected:f})]})}var I=n(34782),S=n(47154),C=n(51404),v=n(88612),k=n(66088),L=n(70539),B=n(24627),P=n(27855),N=n(15239),z=n(9115),F=n(12981),M=n(52619),_=n.n(M),E=n(51012),T=n(99794),R=n(93475),W=n(72378),D=n(44517),H=n(51289);let J=["Latest","Price: Low to High","Price: High to Low"],O=e=>{var t;let{statusSelected:n}=e,{data:s=[],isLoading:c,isError:d}=(0,j.VX)(),[u,x]=(0,o.useState)(8),[f,g]=(0,o.useState)(!1),[m,p]=(0,o.useState)("Latest"),[w,b]=(0,o.useState)(""),[A,y]=(0,o.useState)(!1),[M,O]=(0,o.useState)(null),[U,X]=(0,o.useState)(null),[Y,K]=(0,o.useState)(new Set),Z=null==(t=W.A.get("account"))?void 0:t.toLowerCase(),V=Array.isArray(s)?[...s]:[];if(n.length>0&&(V=V.filter(e=>{let t=null!=e.listingId&&e.listingId>0,i=null!=e.auctionId&&e.auctionId>0;return!!(n.includes("Buy Now")&&t||n.includes("Has Offers")&&t||n.includes("On Auction")&&i)})),w.trim()){let e=w.toLowerCase();V=V.filter(t=>{let n=t.name.toLowerCase().includes(e),i=Array.isArray(t.creator)&&t.creator.some(t=>{var n;return null==(n=t.userName)?void 0:n.toLowerCase().includes(e)});return n||i})}V.sort({"Price: Low to High":(e,t)=>Number(e.price)-Number(t.price),"Price: High to Low":(e,t)=>Number(t.price)-Number(e.price),Latest:()=>0}[m]);let Q=(0,o.useCallback)(async e=>{if(!e.listingId)return alert("Cannot buy this NFT");if(!window.ethereum)return alert("MetaMask not installed");K(t=>new Set(t).add(e.id));try{let t=new E.k(window.ethereum),n=await t.getSigner(),i=await R.v_.getListing(e.listingId),r=BigInt(i.price),s=await R.v_.buyItem(n,e.listingId,r);await s.wait(),X(s.hash),window.location.reload()}catch(e){console.error(e),O(e instanceof Error?e.message:String(e))}finally{K(t=>{let n=new Set(t);return n.delete(e.id),n})}},[]),q=(0,o.useCallback)(async e=>{if(!e.auctionId)return alert("This NFT is not on auction");if(!window.ethereum)return alert("MetaMask not installed");let t=prompt("Enter bid amount in ETH:");if(!t)return;let n=Number(t);if(!(n<=0)){T.g5(n.toString());try{y(!0);let t=new E.k(window.ethereum),i=await t.getSigner(),r=await i.getAddress(),s=T.g5(n.toString()),a=await R.v_.placeBid(i,e.auctionId,s);console.log("Bid receipt:",a);let{error:l}=await H.N.from("auction_bids").insert([{auction_id:e.auctionId,bidder:r,bid_amount:s.toString()}]);l&&console.error("Failed to save bid history:",l),alert("Bid placed successfully!"),window.location.reload()}catch(e){console.error(e),alert(e instanceof Error?e.message:"Error placing bid")}finally{y(!1)}}},[]),G=async e=>{try{if(!window.ethereum)return alert("MetaMask not installed");let t=new E.k(window.ethereum),n=await t.getSigner(),i=await R.v_.cancelListing(n,e);console.log("Receipt:",i),D.Ay.success("Listing canceled successfully!"),window.location.reload()}catch(e){console.error(e),D.Ay.error("Failed to cancel listing")}},$=async e=>{try{if(!window.ethereum)return alert("MetaMask not installed");let t=new E.k(window.ethereum),n=await t.getSigner(),i=await R.v_.cancelAuction(n,e);console.log("Receipt:",i),D.Ay.success("Auction canceled successfully!"),window.location.reload()}catch(e){console.error(e),D.Ay.error("Failed to cancel auction")}};return c?(0,i.jsx)(a.A,{children:"Loading..."}):d?(0,i.jsx)(a.A,{color:"error",children:"Failed to load products"}):(0,i.jsxs)(l.A,{children:[(0,i.jsx)(r.default,{sx:{maxWidth:1200,mx:"auto",width:"100%"},children:(0,i.jsxs)(l.A,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"center",gap:1,mb:4,width:"100%",p:2,children:[(0,i.jsx)(r.default,{sx:{flexBasis:{xs:"100%",sm:"50%"}},children:(0,i.jsx)(h.A,{placeholder:"Search by name or creator",variant:"outlined",size:"small",fullWidth:!0,value:w,onChange:e=>b(e.target.value),InputProps:{startAdornment:(0,i.jsx)(I.A,{position:"start",children:(0,i.jsx)(F.A,{fontSize:"small",sx:{color:"rgba(255,255,255,0.6)"}})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:1.5,background:"rgba(255,255,255,0.2)",input:{p:.8,color:"#fff"},"& input::placeholder":{color:"rgba(255,255,255,0.6)"}}}})}),(0,i.jsx)(r.default,{sx:{flexBasis:{xs:"100%",sm:"20%"},display:"flex",justifyContent:"flex-end"},children:(0,i.jsx)(S.A,{fullWidth:!0,size:"small",children:(0,i.jsx)(C.A,{value:m,onChange:e=>p(e.target.value),sx:{bgcolor:{xs:"rgba(255,255,255,0.2)",md:"white"},borderRadius:1.5},children:J.map(e=>(0,i.jsx)(v.A,{value:e,children:e},e))})})})]})}),(0,i.jsxs)(k.A,{container:!0,spacing:3,mb:14,px:{xs:2,sm:3,md:1},children:[V.slice(0,u).map(e=>(0,i.jsx)(k.A,{size:{xs:12,sm:6,md:4},children:(0,i.jsxs)(L.A,{sx:{bgcolor:"white",borderRadius:3,overflow:"hidden",color:"black",transition:"0.3s",display:"flex",flexDirection:"column",justifyContent:"space-between","&:hover":{transform:"translateY(-6px)",boxShadow:"0 10px 20px rgba(0,0,0,0.3)"},width:"105%",height:"100%"},children:[(0,i.jsxs)(_(),{href:"/marketplace/".concat(e.id),style:{textDecoration:"none"},children:[(0,i.jsx)(r.default,{sx:{width:"100%",height:200,overflow:"hidden",borderRadius:2},children:(0,i.jsx)(N.default,{src:"https://gateway.pinata.cloud/ipfs/".concat(e.image),alt:e.name,width:470,height:200,style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:"center"}})}),(0,i.jsxs)(B.A,{sx:{height:"90%"},children:[(0,i.jsx)(a.A,{variant:"h6",sx:{fontWeight:500},children:e.name}),(0,i.jsxs)(r.default,{sx:{mt:1.2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)(a.A,{variant:"body2",sx:{fontWeight:500,fontSize:"1rem"},children:[e.price," ETH"]}),(0,i.jsx)(z.A,{sx:{fontSize:"0.85rem",opacity:.6}})]})]})]}),(0,i.jsx)(r.default,{sx:{p:1,display:"flex",justifyContent:"center",mt:-2,gap:1},children:(()=>{let t=(Array.isArray(e.seller)?e.seller:e.seller?[e.seller]:[]).some(e=>e.addressWallet.toLowerCase()===(null==Z?void 0:Z.toLowerCase()));return(0,i.jsxs)(i.Fragment,{children:[t&&(0,i.jsxs)(i.Fragment,{children:[null!=e.listingId&&(0,i.jsx)(P.A,{variant:"contained",sx:{bgcolor:"#d32f2f",textTransform:"none",px:4.2},onClick:t=>{t.stopPropagation(),G(e.listingId)},children:"Cancel Buy"}),null!=e.auctionId&&(0,i.jsx)(P.A,{variant:"contained",sx:{bgcolor:"#d32f2f",textTransform:"none",px:4.2},onClick:t=>{t.stopPropagation(),$(e.auctionId)},children:"Cancel Auction"})]}),!t&&e.listingId&&!e.auctionId&&(0,i.jsx)(P.A,{variant:"contained",sx:{bgcolor:"#9230FF",textTransform:"none",px:4.2},disabled:Y.has(e.id),onClick:t=>{t.stopPropagation(),Q(e)},children:Y.has(e.id)?"Processing...":"Buy Now"}),!t&&e.auctionId&&!e.listingId&&(0,i.jsx)(P.A,{variant:"contained",sx:{bgcolor:"#FF8800",textTransform:"none",px:4.2},onClick:t=>{t.stopPropagation(),q(e)},children:"Place Bid"})]})})()})]})},e.id)),(0,i.jsx)(r.default,{display:"flex",justifyContent:"center",mt:3,width:"100%",children:(0,i.jsx)(P.A,{variant:"contained",onClick:()=>{x(f?8:(null==s?void 0:s.length)||8),g(!f)},sx:{p:"6px 12px",borderRadius:1.5,bgcolor:"#232A33",color:"white",width:125,textTransform:"none"},children:f?"See Less":"Load More"})})]}),M&&(0,i.jsx)(a.A,{color:"error",textAlign:"center",children:M})]})},U=()=>{let[e,t]=(0,o.useState)([]),[n,c]=(0,o.useState)(!0);return((0,o.useEffect)(()=>{let e=setTimeout(()=>{c(!1)},1500);return()=>clearTimeout(e)},[]),n)?(0,i.jsx)(r.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#110929",color:"white"},children:(0,i.jsx)(s.A,{sx:{color:"#d622da"}})}):(0,i.jsxs)(r.default,{sx:{position:"relative",minHeight:"100vh",background:"#110929",color:"white",overflow:"hidden"},children:[(0,i.jsx)(r.default,{className:"glow",sx:{"--glow-size":"900px","--glow-left":"-30%","--glow-top":"-1%","--glow-color1":"rgba(214,34,218,0.6)","--glow-color2":"rgba(214,34,218,0.4)","--glow-blur":"100px","--glow-opacity":"0.6"}}),(0,i.jsxs)(r.default,{sx:{px:{xs:2,md:6},pt:10},children:[(0,i.jsxs)(r.default,{sx:{display:"flex",alignItems:"center",mb:5,fontWeight:700},children:[(0,i.jsx)(r.default,{sx:{position:"relative",width:40,height:40,mr:1.5},children:(0,i.jsx)(N.default,{src:"/drop/sparkle.png",alt:"Sparkle",fill:!0,sizes:"(max-width: 600px) 100vw, (max-width: 1200px) 50vw, 450px",style:{objectFit:"contain"}})}),(0,i.jsx)(a.A,{variant:"h4",component:"h1",children:"Explore the Marketplace"})]}),(0,i.jsxs)(l.A,{direction:{xs:"column",sm:"row"},spacing:2,children:[(0,i.jsx)(r.default,{sx:{flexBasis:{xs:"100%",sm:"30%",md:"25%"},flexShrink:0},children:(0,i.jsx)(y,{statusSelected:e,setStatusSelected:t})}),(0,i.jsx)(r.default,{sx:{flexBasis:{xs:"100%",sm:"70%",md:"75%"},flexGrow:1},children:(0,i.jsx)(O,{statusSelected:e})})]})]})]})}},93475:(e,t,n)=>{n.d(t,{PF:()=>d,v_:()=>u});var i=n(51012),r=n(16836),s=n(43338),a=n(99794),l=n(95704);let o="0xe76b09274f7b6681A65975449F9aB3175dd17E51";o||console.warn("⚠️ Thiếu biến NEXT_PUBLIC_MARKETPLACE_ADDRESS trong .env.local");let c=["function listItem(address nftAddress,uint256 tokenId,uint256 price) public returns (uint256)","function cancelListing(uint256 listingId) public","function updateListingPrice(uint256 listingId,uint256 newPrice) public","function buyItem(uint256 listingId) public payable","function createAuction(address nftAddress,uint256 tokenId,uint256 minPrice,uint256 durationSeconds) public returns (uint256)","function placeBid(uint256 auctionId) public payable","function finalizeAuction(uint256 auctionId) public","function cancelAuction(uint256 auctionId) public","function withdraw() public","function pendingWithdrawals(address user) public view returns (uint256)","function getListing(uint256 listingId) public view returns (tuple(address seller,address nftAddress,uint256 tokenId,uint256 price,bool active))","function getAuction(uint256 auctionId) public view returns (tuple(address seller,address nftAddress,uint256 tokenId,uint256 minPrice,uint256 highestBid,address highestBidder,uint256 startTime,uint256 endTime,bool settled))"];function d(e){let t=null!=e?e:window.ethereum?new i.k(window.ethereum):new r.FR(l.env.NEXT_PUBLIC_RPC_URL||"https://rpc.zerochain.network");return new s.NZ(o,c,t)}let u={listItem:async(e,t,n,i)=>{let r=d().connect(e);return(await r.listItem(t,n,(0,a.g5)(i.toString()))).wait()},cancelListing:async(e,t)=>{let n=d().connect(e);return(await n.cancelListing(t)).wait()},updateListingPrice:async(e,t,n)=>{let i=d().connect(e);return(await i.updateListingPrice(t,(0,a.g5)(n.toString()))).wait()},buyItem:async(e,t,n)=>{let i=d().connect(e),r=await i.buyItem(t,{value:n});return await r.wait(),r},createAuction:async(e,t,n,i,r)=>{let s=d().connect(e);return(await s.createAuction(t,n,(0,a.g5)(i.toString()),r)).wait()},placeBid:async(e,t,n)=>{let i=d().connect(e);return(await i.placeBid(t,{value:n})).wait()},finalizeAuction:async(e,t)=>{let n=d().connect(e);return(await n.finalizeAuction(t)).wait()},cancelAuction:async(e,t)=>{let n=d().connect(e);return(await n.cancelAuction(t)).wait()},withdraw:async e=>{let t=d().connect(e);return(await t.withdraw()).wait()},getListing:async e=>{let t=d(),n=await t.getListing(e);return{seller:n.seller,nftAddress:n.nftAddress,tokenId:n.tokenId,price:n.price,active:n.active}},getAuction:async e=>{let t=d(),n=await t.getAuction(e);return{seller:n.seller,nftAddress:n.nftAddress,tokenId:n.tokenId,minPrice:n.minPrice,highestBid:n.highestBid,highestBidder:n.highestBidder,startTime:n.startTime,endTime:n.endTime,settled:n.settled}}}}}]);